# ğŸ§  Emotion Recognition using Deep Learning via Facial Expression

---

## ğŸ‘¥ Team Members

| Name                     | Student ID |
| ------------------------ | ---------- |
| **MM Al Irfan Bhuiyan**  | S372087    |
| **Hasnain Khan**         | S371833    |
| **Hasnain Reza Khetani** | S374688    |
| **Hamza Gul**            | S372115    |

---

## ğŸ“˜ Project Overview

This project implements an **Emotion Recognition System** using an **ensemble of nine convolutional neural networks (CNNs)**.
It classifies facial emotions from the **FER-2013 dataset** and provides an **interactive Streamlit web interface** for image upload or webcam capture.
All experiments, model training, and deployment were performed on **Google Colab** and **Kaggle**.

---

## ğŸ“ Folder Structure

```
SOURCE CODE/
â”‚
â”œâ”€â”€ application/
â”‚   â””â”€â”€ app.py                  â† Streamlit app
â”‚
â”œâ”€â”€ ensembling/
â”‚   â”œâ”€â”€ ensembletesting.ipynb
â”‚   â””â”€â”€ final_application_and_ensembling.ipynb
â”‚
â”œâ”€â”€ Models Training/
â”‚   â”œâ”€â”€ modeltraining1.ipynb
â”‚   â”œâ”€â”€ modeltraining2.ipynb
â”‚   â”œâ”€â”€ modeltraining3.ipynb
â”‚   â””â”€â”€ modeltraining4.ipynb
â”‚
â”œâ”€â”€ Trained_Models/
â”‚   â”œâ”€â”€ bam_resnet50.pth
â”‚   â”œâ”€â”€ cbam_resnet50.pth
â”‚   â”œâ”€â”€ densenet121.pth
â”‚   â”œâ”€â”€ efficientnet_b2.pth
â”‚   â”œâ”€â”€ googlenet.pth
â”‚   â”œâ”€â”€ inception_v3.pth
â”‚   â”œâ”€â”€ resnet34.pth
â”‚   â”œâ”€â”€ resnet152.pth
â”‚   â”œâ”€â”€ simplecnn.pth
â”‚   â””â”€â”€ vgg19.pth
â”‚
â””â”€â”€ requirements.txt
```

---

## âš™ï¸ 1. Environment Setup (Google Colab)

### Step 1 â€“ Install Required Packages

Run in a Colab cell:

```bash
!pip install -r /content/drive/MyDrive/requirements.txt
```

Main dependencies:

```
streamlit
torch
torchvision
timm
pillow
pandas
numpy
matplotlib
opencv-python-headless
pyngrok
```

---

## â˜ï¸ 2. Mount Google Drive

Upload the complete folder (including `.pth` model files) to your Drive and mount it:

```python
from google.colab import drive
drive.mount('/content/drive')
```

Update the model directory path in **app.py**:

```python
models_path = "/content/drive/MyDrive/Trained_Models"
```

---

## ğŸ“¦ 3. Download FER-2013 Dataset via Kaggle API

1. Upload your **`kaggle.json`** to Colab:

   ```python
   from google.colab import files
   files.upload()   # select kaggle.json
   ```
2. Configure and download:

   ```bash
   !mkdir -p ~/.kaggle
   !mv kaggle.json ~/.kaggle/
   !chmod 600 ~/.kaggle/kaggle.json
   !kaggle datasets download -d msambare/fer2013
   !unzip fer2013.zip -d /content/dataset
   ```

---

## ğŸš€ 4. Launch the Streamlit App

Copy the app to Colab working directory and expose it via **ngrok/localtunnel**:

```bash
!cp /content/drive/MyDrive/application/app.py /content/app.py
!streamlit run app.py & npx localtunnel --port 8501
```

After a few seconds, a **public URL** will appear in the output â€” click it to access the app.

---

## ğŸ–¼ï¸ 5. Using the Application

* Upload or capture an image through the Streamlit interface.
* The ensemble model predicts emotion using all nine CNN architectures.
* Final prediction and confidence distribution are displayed.

---

## ğŸ§  6. Retraining Models (Optional)

If retraining is needed:

1. Open any notebook under `Models Training/`.
2. Adjust dataset paths (Drive mount).
3. Run cells sequentially to produce new `.pth` weight files.
4. Save them inside `Trained_Models/`.

---

## ğŸ Summary

| Task                      | Where to Run | Command                                               |
| ------------------------- | ------------ | ----------------------------------------------------- |
| Mount Drive               | Google Colab | `drive.mount('/content/drive')`                       |
| Install Requirements      | Google Colab | `!pip install -r requirements.txt`                    |
| Download Dataset          | Google Colab | `!kaggle datasets download -d msambare/fer2013`       |
| Launch App                | Google Colab | `!streamlit run app.py & npx localtunnel --port 8501` |
| Retrain Models (Optional) | Google Colab | Run notebooks in *Models Training/*                   |


